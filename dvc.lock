setup_env:
  cmd: ./scripts/setup.sh 1
  deps:
  - path: ./scripts/setup.sh
    md5: 3a3e76685baf84c237412ba9e3a4f0c5
dl_quail:
  cmd: ./src/etl/dl_quail.sh
  deps:
  - path: src/etl/dl_quail.sh
    md5: 35c895bd0b066481c8f7fba6dd57a0cb
  outs:
  - path: data/quail/dev.json
    md5: 710c954716143d6d3c8c2ef2044f5c0c
  - path: data/quail/dev_answers.json
    md5: 1665e633ee7aa0183a45a3749e4e061b
  - path: data/quail/eval.py
    md5: cab53a1ed0c7248b036be788fa60ec3c
  - path: data/quail/train.json
    md5: 5409940d9b8479dc51fe56c9b5607344
  - path: data/quail/train_answers.json
    md5: c1b17d1e9bb8bbce4b28c253e5167001
dl_models:
  cmd: python ./src/etl/dl_models.py -m bert-large-uncased bert-base-uncased bert-base-multilingual-cased
    --overwrite
  deps:
  - path: src/etl/dl_models.py
    md5: c2ca665ea793afe968fff649f0e04717
  outs:
  - path: data/models/bert-base-multilingual-cased
    md5: 670fbb9b45bd8600510f362bd8f3d12e.dir
  - path: data/models/bert-base-uncased
    md5: f2ad4af37921a985dc27c650ee39d8d8.dir
  - path: data/models/bert-large-uncased
    md5: defb07df7011fe80af3a1e6bc843eb2b.dir
tr_quail_train_to_race:
  cmd: src/etl/preprocess_quail_to_race.py data/quail/train.json data/quail/train_answers.json
    -o data/quail_race_fmt/train.json
  deps:
  - path: data/quail/train.json
    md5: 5409940d9b8479dc51fe56c9b5607344
  - path: data/quail/train_answers.json
    md5: c1b17d1e9bb8bbce4b28c253e5167001
  - path: src/etl/preprocess_quail_to_race.py
    md5: d85a3aa72f907adfdef52155b94d55b5
  outs:
  - path: data/quail_race_fmt/train.json
    md5: 6c67d6a9e3c054cf471ef467fbf23e26
tr_quail_dev_to_race:
  cmd: src/etl/preprocess_quail_to_race.py data/quail/dev.json data/quail/dev_answers.json
    -o data/quail_race_fmt/dev.json
  deps:
  - path: data/quail/dev.json
    md5: 710c954716143d6d3c8c2ef2044f5c0c
  - path: data/quail/dev_answers.json
    md5: 1665e633ee7aa0183a45a3749e4e061b
  - path: src/etl/preprocess_quail_to_race.py
    md5: d85a3aa72f907adfdef52155b94d55b5
  outs:
  - path: data/quail_race_fmt/dev.json
    md5: b2573225520d6ae103b7b1f899ebd433
60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384:
  cmd: ./src/processing/run.sh data/specs/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384_experiment.json
  deps:
  - path: data/models/bert-base-uncased
    md5: f2ad4af37921a985dc27c650ee39d8d8.dir
  - path: data/quail/dev_race_fmt.json
    md5: b2573225520d6ae103b7b1f899ebd433
  - path: data/quail/train_race_fmt.json
    md5: 6c67d6a9e3c054cf471ef467fbf23e26
  - path: src/processing/run.sh
    md5: a6e6451269520ba9cf5c4ad7752ba5c5
  params:
    data/specs/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384_experiment.json:
      params.do_eval: true
      params.do_train: true
      params.fp16: true
      params.fp16_opt_level: O1
      params.gradient_accumulation_steps: 8
      params.learning_rate: '5e-05'
      params.max_seq_length: 484
      params.meta: bert-train
      params.model_type: bert
      params.num_train_epochs: 2
      params.task_name: generic
  outs:
  - path: data/metrics/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/eval_metrics.json
    md5: 8d58baf7de2fd620ef34bdad2ed00d4d
  - path: data/models/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/config.json
    md5: fda1d82a923cf7ffd8b9da484296692f
  - path: data/models/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/pytorch_model.bin
    md5: 40074d3d92250cf96f0b5281452d9bad
  - path: data/models/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/special_tokens_map.json
    md5: 8b3fb1023167bb4ab9d70708eb05f6ec
  - path: data/models/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/tokenizer_config.json
    md5: acaa1589c694bf6f6c146b3bac976f67
  - path: data/models/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/training_args.bin
    md5: 819cc6ff7220f79736bcc0090f54f45c
  - path: data/models/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/vocab.txt
    md5: 64800d5d8528ce344256daf115d4965e
  - path: data/results/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/eval_nbest_predictions.json
    md5: 6dfd3979bd758e5eb98d17db22e44472
  - path: data/results/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/eval_predictions.json
    md5: 0bd65d519a1554caf00f1377ec399888
4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df:
  cmd: ./src/processing/run.sh data/specs/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df_experiment.json
  deps:
  - path: data/models/bert-base-uncased
    md5: f2ad4af37921a985dc27c650ee39d8d8.dir
  - path: data/quail/dev_race_fmt.json
    md5: b2573225520d6ae103b7b1f899ebd433
  - path: data/quail/train_race_fmt.json
    md5: 6c67d6a9e3c054cf471ef467fbf23e26
  - path: src/processing/run.sh
    md5: a6e6451269520ba9cf5c4ad7752ba5c5
  params:
    data/specs/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df_experiment.json:
      params.do_eval: true
      params.do_train: true
      params.fp16: true
      params.fp16_opt_level: O1
      params.gradient_accumulation_steps: 8
      params.learning_rate: '5e-05'
      params.max_seq_length: 484
      params.meta: multibert-train
      params.model_type: bert
      params.num_train_epochs: 2
      params.task_name: generic
  outs:
  - path: data/metrics/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/eval_metrics.json
    md5: 1eb25deb82b704b53276400a3b5bbb16
  - path: data/models/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/config.json
    md5: 26625e8e71f502488984908b8043b368
  - path: data/models/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/pytorch_model.bin
    md5: 0c8810c2a465065fa44d136918d51928
  - path: data/models/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/special_tokens_map.json
    md5: 8b3fb1023167bb4ab9d70708eb05f6ec
  - path: data/models/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/tokenizer_config.json
    md5: bd2095a6f1895712b38f5c742a06e4cb
  - path: data/models/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/training_args.bin
    md5: e01be806622db5b133e2358efe0ab7f6
  - path: data/models/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/vocab.txt
    md5: d9d865138d17f1958502ed060ecfeeb6
  - path: data/results/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/eval_nbest_predictions.json
    md5: e6b85a9a3140f4d1e288b736b712e287
  - path: data/results/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/eval_predictions.json
    md5: 0108b1c621b687e399dfb3e698f4580a
4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df_evaluation:
  cmd: mcqa_utils -d data/quail_race_fmt -n data/results/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/eval_nbest_predictions.json
    --split dev --task generic -ft --metrics C_at_1 avg --output data/metrics/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/evaluation.json
  deps:
  - path: data/quail_race_fmt/dev.json
    md5: b2573225520d6ae103b7b1f899ebd433
  - path: data/results/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/eval_nbest_predictions.json
    md5: e6b85a9a3140f4d1e288b736b712e287
  outs:
  - path: data/metrics/4819225caddd2f92c878079d1b17e675eeb5d704de41996605ad6cdb7afc70df/evaluation.json
    md5: d8adda93e515117f0b0506e7d935d883
60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384_evaluation:
  cmd: mcqa_utils -d data/quail_race_fmt -n data/results/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/eval_nbest_predictions.json
    --split dev --task generic -ft --metrics C_at_1 avg --output data/metrics/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/evaluation.json
  deps:
  - path: data/quail_race_fmt/dev.json
    md5: b2573225520d6ae103b7b1f899ebd433
  - path: data/results/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/eval_nbest_predictions.json
    md5: 6dfd3979bd758e5eb98d17db22e44472
  outs:
  - path: data/metrics/60d988dee30ae86536ee58ea2777c69747316251fb6a4e9d2623be788f4a6384/evaluation.json
    md5: ca06e202ba82b581a86913d450c51b04
4888f3b8bec2c7ea4eb89d07ac877fc0c19aa15bbfa74c1bc32c5170abcb8482:
  cmd: ./src/processing/run.sh data/specs/4888f3b8bec2c7ea4eb89d07ac877fc0c19aa15bbfa74c1bc32c5170abcb8482_experiment.json
  deps:
  - path: data/models/eee4b9c4ecad29f96b656c5c85af637ab919d0ac561a95d0914203925d8f4561
    md5: dca4d454a27a7f4b2448fb6729306933.dir
  - path: data/quail/dev_race_fmt.json
    md5: b2573225520d6ae103b7b1f899ebd433
  - path: src/processing/run.sh
    md5: a6e6451269520ba9cf5c4ad7752ba5c5
  params:
    data/specs/4888f3b8bec2c7ea4eb89d07ac877fc0c19aa15bbfa74c1bc32c5170abcb8482_experiment.json:
      params.do_eval: true
      params.fp16: true
      params.fp16_opt_level: O1
      params.gradient_accumulation_steps: 8
      params.learning_rate: '5e-05'
      params.max_seq_length: 484
      params.meta: race-bert
      params.model_type: bert
      params.num_train_epochs: 2
      params.task_name: generic
  outs:
  - path: data/metrics/4888f3b8bec2c7ea4eb89d07ac877fc0c19aa15bbfa74c1bc32c5170abcb8482/eval_metrics.json
    md5: 4bb18899cbd8d143f2eecffaa7ec999e
  - path: data/results/4888f3b8bec2c7ea4eb89d07ac877fc0c19aa15bbfa74c1bc32c5170abcb8482/eval_nbest_predictions.json
    md5: 0a8f0801ceca1382ac6b097e9a8b4bfe
  - path: data/results/4888f3b8bec2c7ea4eb89d07ac877fc0c19aa15bbfa74c1bc32c5170abcb8482/eval_predictions.json
    md5: e1fab2f68535bce1a1111e616d217a08
94348d79ad84fec361b4d7c5030331591ca70d07b26836691880ae1939f18021:
  cmd: ./src/processing/run.sh data/specs/94348d79ad84fec361b4d7c5030331591ca70d07b26836691880ae1939f18021_experiment.json
  deps:
  - path: data/models/12942b9ce5eb231bd51d867a17ff9b243de813ae44de6056b5066ac67a7131b2
    md5: b379cdb57a3ed0541bb2a370c2fede28.dir
  - path: data/quail/dev_race_fmt.json
    md5: b2573225520d6ae103b7b1f899ebd433
  - path: src/processing/run.sh
    md5: a6e6451269520ba9cf5c4ad7752ba5c5
  params:
    data/specs/94348d79ad84fec361b4d7c5030331591ca70d07b26836691880ae1939f18021_experiment.json:
      params.do_eval: true
      params.fp16: true
      params.fp16_opt_level: O1
      params.gradient_accumulation_steps: 8
      params.learning_rate: '5e-05'
      params.max_seq_length: 484
      params.meta: race-multibert
      params.model_type: bert
      params.num_train_epochs: 2
      params.task_name: generic
  outs:
  - path: data/metrics/94348d79ad84fec361b4d7c5030331591ca70d07b26836691880ae1939f18021/eval_metrics.json
    md5: 99d08cf545a91b092813cfc8d7d04e78
  - path: data/results/94348d79ad84fec361b4d7c5030331591ca70d07b26836691880ae1939f18021/eval_nbest_predictions.json
    md5: e3804480184f7893952caa4479f5e9fa
  - path: data/results/94348d79ad84fec361b4d7c5030331591ca70d07b26836691880ae1939f18021/eval_predictions.json
    md5: 9c01d8eb56a8a00bf11acd44585a5966
