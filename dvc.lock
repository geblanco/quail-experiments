schema: '2.0'
stages:
  dl_quail:
    cmd: ./src/etl/dl_quail.sh
    deps:
    - path: src/etl/dl_quail.sh
      md5: 35c895bd0b066481c8f7fba6dd57a0cb
      size: 824
    outs:
    - path: data/quail/dev.json
      md5: 710c954716143d6d3c8c2ef2044f5c0c
      size: 955449
    - path: data/quail/dev_answers.json
      md5: 1665e633ee7aa0183a45a3749e4e061b
      size: 46710
    - path: data/quail/eval.py
      md5: cab53a1ed0c7248b036be788fa60ec3c
      size: 1446
    - path: data/quail/train.json
      md5: 5409940d9b8479dc51fe56c9b5607344
      size: 4498702
    - path: data/quail/train_answers.json
      md5: c1b17d1e9bb8bbce4b28c253e5167001
      size: 199358
  tr_quail_dev_to_race:
    cmd: src/etl/preprocess_quail_to_race.py data/quail/dev.json data/quail/dev_answers.json
      -o data/quail_race_fmt/dev.json
    deps:
    - path: data/quail/dev.json
      md5: 710c954716143d6d3c8c2ef2044f5c0c
      size: 955449
    - path: data/quail/dev_answers.json
      md5: 1665e633ee7aa0183a45a3749e4e061b
      size: 46710
    - path: src/etl/preprocess_quail_to_race.py
      md5: d85a3aa72f907adfdef52155b94d55b5
      size: 3261
    outs:
    - path: data/quail_race_fmt/dev.json
      md5: b2573225520d6ae103b7b1f899ebd433
      size: 611156
  tr_quail_train_to_race:
    cmd: src/etl/preprocess_quail_to_race.py data/quail/train.json data/quail/train_answers.json
      -o data/quail_race_fmt/train.json
    deps:
    - path: data/quail/train.json
      md5: 5409940d9b8479dc51fe56c9b5607344
      size: 4498702
    - path: data/quail/train_answers.json
      md5: c1b17d1e9bb8bbce4b28c253e5167001
      size: 199358
    - path: src/etl/preprocess_quail_to_race.py
      md5: d85a3aa72f907adfdef52155b94d55b5
      size: 3261
    outs:
    - path: data/quail_race_fmt/train.json
      md5: 6c67d6a9e3c054cf471ef467fbf23e26
      size: 2863957
  tr_quail_dev_no_empty_answers:
    cmd: python src/etl/choices/reformat_dataset.py -d ./data/quail_race_fmt -o ./data/quail_no_empty_answers
      -s dev --no_answer_text "not enough information" --keep_matching_text --index_list_path
      ./data/quail_no_empty_answers/dev_index_list.json
    deps:
    - path: data/quail_race_fmt
      md5: a285061c0fce5446207646fcddcecfeb.dir
      size: 3475135
      nfiles: 3
    - path: src/etl/choices/reformat_dataset.py
      md5: e8e3c8d3f5afcfc5c8c9fda62296ac7d
      size: 4721
    outs:
    - path: ./data/quail_no_empty_answers/dev_index_list.json
      md5: df9910f3a043308666bffbeb9fcebe5e
      size: 30297
    - path: data/quail_no_empty_answers/dev.json
      md5: 0527f4f70f20380b3eb7b506c063a7d8
      size: 554890
  tr_quail_train_no_empty_answers:
    cmd: python src/etl/choices/reformat_dataset.py -d data/quail_race_fmt -o data/quail_no_empty_answers
      -s train --no_answer_text "not enough information"
    deps:
    - path: data/quail_race_fmt
      md5: a285061c0fce5446207646fcddcecfeb.dir
      size: 3475135
      nfiles: 3
    - path: src/etl/choices/reformat_dataset.py
      md5: e8e3c8d3f5afcfc5c8c9fda62296ac7d
      size: 4721
    outs:
    - path: data/quail_no_empty_answers/train.json
      md5: d3a6f28fa96f7431cee0ec4aa4193105
      size: 2451755
  dl_models:
    cmd: python ./src/etl/dl_models.py -m bert-base-uncased --overwrite
    deps:
    - path: src/etl/dl_models.py
      md5: c2ca665ea793afe968fff649f0e04717
      size: 2452
    outs:
    - path: data/models/bert-base-uncased
      md5: be46589e12f830a3e7955451e37136ae.dir
      size: 438215920
      nfiles: 5
